{"title":"Introduction","markdown":{"yaml":{"title":"","format":{"html":{"embed-resources":true,"toc":true}},"jupyter":"python3","execute":{"echo":false}},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n\nThe effects of climate change are rapidly becoming more apparent in our daily lives and in the data collected by researchers from the Southwestern Utah Group (SEUG) of National Parks. Over the past decade, there have been increasing reports of extreme weather, such as flooding, drought, hurricanes, and other natural diasasters. These natural diasasters have disrupted livelihoods and agricultural systems. In an effort by the Southwestern Utah Group (SEUG) of National Parks, researchers collected data around the Natural Bridges National Monument. This data included parameters, such as temperature, precipitation, volumetric water content in soil, and agricultural metrics (such as tree canopy coverage, herbaceous coverage, percentage of bare ground, plant litter, shrub coverage).  \n\n\n```{python, echo=False}\nimport pandas as pd\nimport numpy as np\n\nimport folium\nfrom folium.plugins import HeatMapWithTime\nfrom sklearn.preprocessing import StandardScaler\nfrom matplotlib import style\n\nimport seaborn as sns \nimport seaborn.objects as so\n```\n\n```{python, echo=False}\ncpalette = sns.color_palette(['#332288','#E40B5A','#4C91D1','#D29E08','#6B892F'])\nsns.set_palette(cpalette)\nsns.set_style(\n    style='darkgrid')\n\nupdates = {\n    'axes.titlesize': 28, \n    'axes.labelsize': 19, \n    'axes.titlelocation': 'center', \n    'text.color': '172626', #shade of dark cyan\n    'mathtext.fontset': 'dejavuserif',\n    'axes.labelcolor': 'red',\n    'axes.edgecolor': '9AC1C1', #shade of dark cyan\n    'legend.facecolor': 'white', \n    'legend.edgecolor': '558B8B', #shade of dark cyan\n    'axes.facecolor': 'D9E8E8', #shade of dark cyan\n    'figure.facecolor': '99C2C2', #shade of dark cyan\n    'font.family': 'Verdana', \n    'font.sans-serif': \"Verdana\",\n    'grid.color': 'F2F7F7', #shade of dark cyan\n    'grid.linestyle': '-',   \n    'grid.linewidth': 1,\n    'legend.loc': 'lower right'}\n\n# remember to add this update to seaborn to update the point colors\nsns.set_palette(cpalette)    \n\n#update with new specs, layer them by merging the dictionaries\nnew_specs = {**sns.axes_style('darkgrid'), **updates} \n\n```\n\n```{python, echo=False}\nclimate = pd.read_csv('../data/NABR_historic.csv')\n#print(climate.info())\n#print(climate.head())\n```\n\n```{python, echo=False}\nclimate_near = pd.read_csv('../data/nearterm_data_2020-2024.csv')\n#print(climate_near.info())\n#print(climate_near.head())\n```\n\n```{python, echo=False}\nclimate_main = pd.concat([climate, climate_near], ignore_index=True)\n#print(climate_main.shape)\n#print(climate_main.info())\n```\n\n```{python, echo=False}\n# Create a list of years for the time index\nclimate2 = climate_main[['lat', 'long', 'year', 'T_Annual']]\nclimate2 = climate2.dropna()\n\n# find average per lat and long from 1980 to 2000\nclimate3 = climate2[climate2['year'] <= 2000]\nclimate3 = climate3.groupby(['lat', 'long'])['T_Annual'].max().reset_index()\nclimate3 = climate3.rename(columns={'T_Annual': 'T_Annual_Max'})\n#print(climate3)\n```\n\n```{python, echo=False}\nclimate2 = climate2.groupby(['year', 'lat', 'long'])['T_Annual'].max().reset_index()\nclimate2 = pd.merge(climate2, climate3, on=['lat', 'long'], how='left')\nclimate2 = climate2.dropna()\n#print(climate2.head())\n```\n\n```{python, echo=False}\nclimate2['T_delta'] = climate2['T_Annual'] - climate2['T_Annual_Max']\n#print(climate2.head())\n```\n\n```{python, echo=False}\n#climate2['T_delta_normal'] = (climate2['T_delta'] - climate2['T_delta'].min()) / (climate2['T_delta'].max() - climate2['T_delta'].min())\nscaler = StandardScaler()\nclimate2['T_delta_normal'] = scaler.fit_transform(climate2[['T_delta']])\n#print(climate2.head())\n```\n\n```{python, echo=False}\nclimate2 = climate2[climate2['year']>=1983]\n#print(climate2.tail())\n```\n\n# Increase in Extreme High Annual Temperatures\n\nFrom 2021 to 2024, the Natural Bridges National Monument had the highest temperatures recorded ranging from 24 to 26 degrees celsius. \n\n```{python, echo=False}\n#| fig-cap: \"Beginning with data in 1983 and ending in 2024, each maximum annual temperature was compared to the maximum temperature between 1980 to 2000. The red color increases in intensity as the change in temperature increases. The most remarkable difference is seen by comparing 1983 and 2024.\"\n\nyears = climate2['year'].unique()\nyears.sort()\n\nheat_df = []\nfor year in years:\n    # Filter data for this iteration of year\n    year_df = climate2[climate2['year'] == year]\n    # Create a list of [lat, lon, T_delta_normal] for this iteration of year\n    heat_df.append(year_df[['lat', 'long', 'T_delta_normal']].values.tolist())\n\n# Initialize base layer of Folium map\nm = folium.Map(location=[climate2['lat'].mean(), climate2['long'].mean()], control_scale=True, zoom_start=13)\n\n# Add heat map layer\nHeatMapWithTime(\n    heat_df,\n    index=years.tolist(),\n    auto_play=True,\n    min_speed=3.5,\n    max_opacity=0.7,\n    radius=25\n).add_to(m)\n\nm\n```\n\n\n\nThe increase in extreme weather is striking with a steep increase in extreme temperature between 2021 to 2024. According to NASA, one-degree is global temperature change has a significant impact on the warming of oceans, the atmosphere, and the land masses. For example, NASA stated that \"A five-degree drop was enough to bury a large part of North America under a towering mass of ice 20,000 years ago.\" \n\n```{python, echo=False}\n#| fig-cap: \"The average of the highest annual temperature per year was calculated. Alarmingly, there is a steep increase in extreme temperature between 2021 to 2024.\"\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\n\naverage_temp_per_year = climate2.groupby('year')['T_Annual'].mean()\n\n\nplt.figure(figsize=(8, 6))  \nplt.plot(average_temp_per_year.index, average_temp_per_year.values, marker='o', linestyle='-')\nplt.title('Highest Annual Temperature from 1983 to 2024', fontsize=28)\nplt.xlabel('Year')\nplt.ylabel('Highest Annual Temperature (in Celsius)')\nplt.grid(True)\nplt.xticks(average_temp_per_year.index, rotation=45) \nplt.tight_layout()  \nplt.show()\n```\n\n```{python, echo=False}\nclimate2_per = climate_main[['lat', 'long', 'year', 'PPT_Annual']]\nclimate2_per = climate2_per.dropna()\n\n# find average annual PPT per lat and long from 1980 to 2000\nclimate3_per = climate2_per[climate2_per['year'] <= 2000]\nclimate3_per = climate3_per.groupby(['lat', 'long'])['PPT_Annual'].mean().reset_index()\nclimate3_per = climate3_per.rename(columns={'PPT_Annual': 'PPT_Annual_Avg'})\n#print(climate3_per)\n```\n\n```{python, echo=False}\n# find average PPT_Annual per year, lat, long\nclimate2_per = climate2_per.groupby(['year', 'lat', 'long'])['PPT_Annual'].mean().reset_index()\nclimate2_per = pd.merge(climate2_per, climate3_per, on=['lat', 'long'], how='left')\nclimate2_per = climate2_per.dropna()\n#print(climate2_per.head())\n```\n\n```{python, echo=False}\n# find change\nclimate2_per['PPT_delta'] = climate2_per['PPT_Annual'] - climate2_per['PPT_Annual_Avg']\n#print(climate2_per.head())\n```\n\n```{python, echo=False}\n# normalize data\nscaler = StandardScaler()\nclimate2_per['PPT_delta_normal'] = scaler.fit_transform(climate2_per[['PPT_delta']])\n#print(climate2_per.head())\n```\n\n```{python, echo=False}\nclimate2_per = climate2_per[climate2_per['year']>=1983]\n```\n\n# Changing Precipitation Patterns\n\nPrecipitation patterns have also been changing in this region. As seen in the map below, there are fluctuations in the precipitation patterns from 1983 to 2024, but overall there is a downward trend in the average annual precipitation.\n\n```{python, echo=False}\n#| fig-cap: \"Beginning with data in 1983 and ending in 2024, each average annual precipitation was compared to the average annual precipitation between 1980 to 2000. The blue color decreases in intensity as precipitation decreases. The most remarkable difference is seen by comparing 1983 and 2024.\"\nyears = climate2_per['year'].unique()\nyears.sort()\n\nheat_df = []\nfor year in years:\n    year_df = climate2_per[climate2_per['year'] == year]\n    heat_df.append(year_df[['lat', 'long', 'PPT_delta_normal']].values.tolist())\n\n# Create a base map\nm = folium.Map(location=[climate2_per['lat'].mean(), climate2_per['long'].mean()], control_scale=True, zoom_start=13)\n\n# Add heatmap with time plugin\nHeatMapWithTime(\n    heat_df,\n    index=years.tolist(),\n    auto_play=True,\n    min_speed=3.5,\n    max_opacity=0.7,\n    gradient = {0.25: 'red', 0.5: 'yellow', 0.75: 'green', 1: 'blue'},\n    radius=25\n).add_to(m)\n\nm\n```\n\n\n\n```{python, echo=False}\naverage_prec_per_year = climate2_per.groupby('year')['PPT_Annual'].mean()\n\n\nplt.figure(figsize=(8, 6))  \nplt.plot(average_prec_per_year.index, average_prec_per_year.values, marker='o', linestyle='-')\nplt.title('Annual Precipitation from 1983 to 2024', fontsize=28)\nplt.xlabel('Year')\nplt.ylabel('Average Annual Precipitation')\nplt.grid(True)\nplt.xticks(average_prec_per_year.index, rotation=45) \nplt.tight_layout()  \nplt.show()\n```\n\n\n```{python, echo=False}\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler\n```\n\n```{python, echo=False}\nfrom matplotlib import style\n```\n\n```{python, echo=False}\nclimate = pd.read_csv('../data/NABR_historic.csv')\n#print(climate.info())\n#print(climate.head())\n```\n\n```{python, echo=False}\nclimate_near = pd.read_csv('../data/nearterm_data_2020-2024.csv')\n#print(climate_near.info())\n#print(climate_near.head())\n```\n\n```{python, echo=False}\nclimate_main = pd.concat([climate, climate_near], ignore_index=True)\n#print(climate_main.shape)\n#print(climate_main.info())\n```\n\n```{python, echo=False}\n#print(climate_main['RCP'].unique())\n```\n\n```{python, echo=False}\nclimate_main = climate_main.drop(columns=['TimePeriod', 'scenario', 'RCP'])\nscaler = StandardScaler()\nclimate_main_normal = scaler.fit_transform(climate_main)\nclimate_main = pd.DataFrame(climate_main_normal, columns=climate_main.columns)\n```\n\n\n\n```{python, echo=False}\nclimate_main = climate_main.rename(columns={'Ann_Herb': 'annual herb', 'Bare': 'bare ground', 'Herb': 'herb',\n       'Litter': 'plant litter', 'Shrub': 'shurbs', 'DrySoilDays_Summer_whole': 'dry soil days' , 'Evap_Summer': 'evap in summer',\n       'ExtremeShortTermDryStress_Summer_whole': 'extreme dry soil', 'FrostDays_Winter': 'frost days in winter',\n       'NonDrySWA_Summer_whole': 'non-dry soil water', 'PPT_Winter': 'PPT Winter', 'PPT_Summer': 'PPT Summer', \n       'PPT_Annual': 'PPT Annual',\n       'T_Winter': 'Temp Winter', 'T_Summer': 'Temp Summer', 'T_Annual': 'Temp Annual', 'Tmax_Summer': 'Max Temp Summer', \n       'Tmin_Winter': 'Min Temp Winter',\n       'VWC_Winter_whole': 'VWC Winter', 'VWC_Spring_whole': 'VWC Spring', 'VWC_Summer_whole': 'VWC Summer',\n       'VWC_Fall_whole': 'VWC Fall'})\n```\n\n```{python, echo=False}\n#climate_main1 = climate_main.drop(columns=['TimePeriod', 'scenario'])\nclimate_main1 = climate_main.drop(columns=['Min Temp Winter', 'VWC Winter', 'VWC Spring',\n                                          'VWC Summer', 'VWC Fall',\n                                          'non-dry soil water', 'frost days in winter',\n                                          'extreme dry soil',\n                                          'evap in summer', 'dry soil days'])\n\nclimate_main1 = climate_main1.dropna()\n#print(climate_main1.shape)\n#print(climate_main1.info())\n```\n\n```{python, echo=False}\nclimate_main2 = climate_main.drop(columns=['PPT Winter', 'PPT Summer', 'PPT Annual',\n                                          'Temp Winter', 'Temp Summer',\n                                          'Temp Annual', 'Max Temp Summer'])\n#climate_main2_normal = scaler.fit_transform(climate_main2)\n#climate_main2= pd.DataFrame(climate_main2_normal, columns=climate_main2.columns)\n#climate_main2 = climate_main2.dropna()\n#print(climate_main2.shape)\n#print(climate_main2.info())\n```\n\n```{python, echo=False}\ncorr_matrix = climate_main.dropna()\n#print(corr_matrix.info())\n```\n\n```{python, echo=False}\n\n\n#corr_matrix = corr_matrix.corr(method='pearson')\n\n#sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0)\n#plt.show()\n```\n\n# Impact on Precipitation and Water Content in Soil\n\nChanges in annual temperature and precipitation may have impacts on other environmental factors. In the Pearson Correlation Plots below, subtle relationships are seen between temperature and precipitation to volumetric water content (VWC) and water available in dry soil. \n\n```{python, echo=False}\n#| fig-cap: \"The increasing intensity of the red color indicates a strong positive relationship while the blue color indicates an inverse relationship.\"\ncorr_matrix1 = climate_main1.corr(method='pearson')\n\nsns.heatmap(corr_matrix1, annot=True, cmap='coolwarm', center=0)\nplt.show()\n```\n\n\n```{python, echo=False}\n#| fig-cap: \"The increasing intensity of the red color indicates a strong positive relationship while the blue color indicates an inverse relationship.\"\ncorr_matrix2 = climate_main2.corr(method='pearson')\n\nsns.heatmap(corr_matrix2, annot=True, cmap='coolwarm')\nplt.show()\n```\n\n\n\n\n```{python, echo=False}\n#print(climate_main2.info())\n```\n\n```{python, echo=False}\n\nclimate_main2_mean = climate_main2.groupby(['long', 'lat', 'year']).agg({\n    'non-dry soil water': 'mean',\n    'VWC Winter': 'mean',\n    'VWC Spring': 'mean',\n    'VWC Summer': 'mean',\n    'VWC Fall': 'mean',\n}).reset_index()\n```\n\n```{python, echo=False}\n#print(climate_main2_mean.head())\n```\n\n\nThe Pearson correlation matrix show the beginnings of the impact of changes in temperature and precipitation. \n\n\n```{python, echo=False}\n#| fig-cap: \"This figure takes a closer look at the relationship between non-dry soil water availability during the summer.\"\nimport plotly.graph_objects as go\nimport pandas as pd\n\n\nfig = go.Figure(\n    data=go.Splom(\n        dimensions=[\n            dict(label=\"non-dry soil water\", values=climate_main2[\"non-dry soil water\"]),\n            dict(label=\"VWC Winter\", values=climate_main2[\"VWC Winter\"]),\n            dict(label=\"VWC Spring\", values=climate_main2[\"VWC Spring\"]),\n            dict(label=\"VWC Summer\", values=climate_main2[\"VWC Summer\"]),\n            dict(label=\"VWC Fall\", values=climate_main2[\"VWC Fall\"]),\n        ],\n        showupperhalf=False,\n        marker=dict(\n            showscale=False,\n            line_color=\"white\",\n            line_width=0.5,\n        ),\n    )\n)\n\nfig.update_layout(\n    title=\"Relationship between Non-dry Soil Water Availability and Seasonal VWC\",\n    hovermode=\"closest\",\n    width=800,\n    height=800,\n)\n\n#fig.theme(style.library[\"\"])\n\nfig.show()\n```\n\n\nIn this parallel coordinates plot, the extreme values at above 3.5 show a relationship to a decrease in volumetric water content (VWC) in winter, spring, summer, and fall. According to Sumon Datta et. al., VWC can influence plant growth, soil temperature, transport of chemicals and groundwater recharge.\n\n```{python, echo=False}\n#| fig-cap: \"By scrolling over the axis, a closer look at the relationship between extreme dry soil and VWC.\"\nfig = go.Figure(data=\n    go.Parcoords(\n        line = dict(#color = df['species_id'],\n                   colorscale = [[0,'purple'],[0.5,'lightseagreen'],[1,'gold']]),\n        dimensions = list([\n            dict(range = [0,6],\n                constraintrange = [4,6],\n                label=\"extreme dry soil\", values=climate_main2[\"extreme dry soil\"]),\n            dict(range = [0,6],\n                label=\"VWC Winter\", values=climate_main2[\"VWC Winter\"]),\n            dict(range = [0,6],\n                label=\"VWC Spring\", values=climate_main2[\"VWC Spring\"]),\n            dict(range = [0,6],\n                label=\"VWC Summer\", values=climate_main2[\"VWC Summer\"]),\n            dict(range = [0,6],\n                label=\"VWC Fall\", values=climate_main2[\"VWC Fall\"])\n        ])\n    )\n)\n\nfig.update_layout(\n    plot_bgcolor = 'white',\n    paper_bgcolor = 'white',\n    height = 450\n)\n\nfig.show()\n\n```\n\n# Conclusion\n\nThe data collected by the Southwestern Utah Group (SEUG) of National Parks shows the striking increase in extreme high temperatures, changes in precipitation, and subtle changes in water content in soil. These patterns have profound implications on our ecosystems. In an article by NASA, even one degree of temperature change can have catatrophic effects on the global ecosytem. Changes in temperature and precipitation may have negative impacts on our agricultural systems, which may also cause stress and strain on our future food sytems. It is critical that policy makers act urgently to reverse the effects of climate change. \n\n\n# Referenes\n\n1. NASA. (n.d.). Effects - NASA science. NASA. https://science.nasa.gov/climate-change/effects/ \n2. NASA. (n.d.-b). World of change: Global temperatures. NASA. https://earthobservatory.nasa.gov/world-of-change/global-temperatures\n3. Datta, S, et. al. (2018, August 1). Understanding soil water content and thresholds for irrigation management - Oklahoma State University. Understanding Soil Water Content and Thresholds for Irrigation Management | Oklahoma State University. https://extension.okstate.edu/fact-sheets/understanding-soil-water-content-and-thresholds-for-irrigation-management.html#:~:text=The%20volumetric%20water%20content%20is,water%20per%20foot%20of%20soil. \n\n","srcMarkdownNoYaml":"\n\n# Introduction\n\nThe effects of climate change are rapidly becoming more apparent in our daily lives and in the data collected by researchers from the Southwestern Utah Group (SEUG) of National Parks. Over the past decade, there have been increasing reports of extreme weather, such as flooding, drought, hurricanes, and other natural diasasters. These natural diasasters have disrupted livelihoods and agricultural systems. In an effort by the Southwestern Utah Group (SEUG) of National Parks, researchers collected data around the Natural Bridges National Monument. This data included parameters, such as temperature, precipitation, volumetric water content in soil, and agricultural metrics (such as tree canopy coverage, herbaceous coverage, percentage of bare ground, plant litter, shrub coverage).  \n\n\n```{python, echo=False}\nimport pandas as pd\nimport numpy as np\n\nimport folium\nfrom folium.plugins import HeatMapWithTime\nfrom sklearn.preprocessing import StandardScaler\nfrom matplotlib import style\n\nimport seaborn as sns \nimport seaborn.objects as so\n```\n\n```{python, echo=False}\ncpalette = sns.color_palette(['#332288','#E40B5A','#4C91D1','#D29E08','#6B892F'])\nsns.set_palette(cpalette)\nsns.set_style(\n    style='darkgrid')\n\nupdates = {\n    'axes.titlesize': 28, \n    'axes.labelsize': 19, \n    'axes.titlelocation': 'center', \n    'text.color': '172626', #shade of dark cyan\n    'mathtext.fontset': 'dejavuserif',\n    'axes.labelcolor': 'red',\n    'axes.edgecolor': '9AC1C1', #shade of dark cyan\n    'legend.facecolor': 'white', \n    'legend.edgecolor': '558B8B', #shade of dark cyan\n    'axes.facecolor': 'D9E8E8', #shade of dark cyan\n    'figure.facecolor': '99C2C2', #shade of dark cyan\n    'font.family': 'Verdana', \n    'font.sans-serif': \"Verdana\",\n    'grid.color': 'F2F7F7', #shade of dark cyan\n    'grid.linestyle': '-',   \n    'grid.linewidth': 1,\n    'legend.loc': 'lower right'}\n\n# remember to add this update to seaborn to update the point colors\nsns.set_palette(cpalette)    \n\n#update with new specs, layer them by merging the dictionaries\nnew_specs = {**sns.axes_style('darkgrid'), **updates} \n\n```\n\n```{python, echo=False}\nclimate = pd.read_csv('../data/NABR_historic.csv')\n#print(climate.info())\n#print(climate.head())\n```\n\n```{python, echo=False}\nclimate_near = pd.read_csv('../data/nearterm_data_2020-2024.csv')\n#print(climate_near.info())\n#print(climate_near.head())\n```\n\n```{python, echo=False}\nclimate_main = pd.concat([climate, climate_near], ignore_index=True)\n#print(climate_main.shape)\n#print(climate_main.info())\n```\n\n```{python, echo=False}\n# Create a list of years for the time index\nclimate2 = climate_main[['lat', 'long', 'year', 'T_Annual']]\nclimate2 = climate2.dropna()\n\n# find average per lat and long from 1980 to 2000\nclimate3 = climate2[climate2['year'] <= 2000]\nclimate3 = climate3.groupby(['lat', 'long'])['T_Annual'].max().reset_index()\nclimate3 = climate3.rename(columns={'T_Annual': 'T_Annual_Max'})\n#print(climate3)\n```\n\n```{python, echo=False}\nclimate2 = climate2.groupby(['year', 'lat', 'long'])['T_Annual'].max().reset_index()\nclimate2 = pd.merge(climate2, climate3, on=['lat', 'long'], how='left')\nclimate2 = climate2.dropna()\n#print(climate2.head())\n```\n\n```{python, echo=False}\nclimate2['T_delta'] = climate2['T_Annual'] - climate2['T_Annual_Max']\n#print(climate2.head())\n```\n\n```{python, echo=False}\n#climate2['T_delta_normal'] = (climate2['T_delta'] - climate2['T_delta'].min()) / (climate2['T_delta'].max() - climate2['T_delta'].min())\nscaler = StandardScaler()\nclimate2['T_delta_normal'] = scaler.fit_transform(climate2[['T_delta']])\n#print(climate2.head())\n```\n\n```{python, echo=False}\nclimate2 = climate2[climate2['year']>=1983]\n#print(climate2.tail())\n```\n\n# Increase in Extreme High Annual Temperatures\n\nFrom 2021 to 2024, the Natural Bridges National Monument had the highest temperatures recorded ranging from 24 to 26 degrees celsius. \n\n```{python, echo=False}\n#| fig-cap: \"Beginning with data in 1983 and ending in 2024, each maximum annual temperature was compared to the maximum temperature between 1980 to 2000. The red color increases in intensity as the change in temperature increases. The most remarkable difference is seen by comparing 1983 and 2024.\"\n\nyears = climate2['year'].unique()\nyears.sort()\n\nheat_df = []\nfor year in years:\n    # Filter data for this iteration of year\n    year_df = climate2[climate2['year'] == year]\n    # Create a list of [lat, lon, T_delta_normal] for this iteration of year\n    heat_df.append(year_df[['lat', 'long', 'T_delta_normal']].values.tolist())\n\n# Initialize base layer of Folium map\nm = folium.Map(location=[climate2['lat'].mean(), climate2['long'].mean()], control_scale=True, zoom_start=13)\n\n# Add heat map layer\nHeatMapWithTime(\n    heat_df,\n    index=years.tolist(),\n    auto_play=True,\n    min_speed=3.5,\n    max_opacity=0.7,\n    radius=25\n).add_to(m)\n\nm\n```\n\n\n\nThe increase in extreme weather is striking with a steep increase in extreme temperature between 2021 to 2024. According to NASA, one-degree is global temperature change has a significant impact on the warming of oceans, the atmosphere, and the land masses. For example, NASA stated that \"A five-degree drop was enough to bury a large part of North America under a towering mass of ice 20,000 years ago.\" \n\n```{python, echo=False}\n#| fig-cap: \"The average of the highest annual temperature per year was calculated. Alarmingly, there is a steep increase in extreme temperature between 2021 to 2024.\"\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\n\naverage_temp_per_year = climate2.groupby('year')['T_Annual'].mean()\n\n\nplt.figure(figsize=(8, 6))  \nplt.plot(average_temp_per_year.index, average_temp_per_year.values, marker='o', linestyle='-')\nplt.title('Highest Annual Temperature from 1983 to 2024', fontsize=28)\nplt.xlabel('Year')\nplt.ylabel('Highest Annual Temperature (in Celsius)')\nplt.grid(True)\nplt.xticks(average_temp_per_year.index, rotation=45) \nplt.tight_layout()  \nplt.show()\n```\n\n```{python, echo=False}\nclimate2_per = climate_main[['lat', 'long', 'year', 'PPT_Annual']]\nclimate2_per = climate2_per.dropna()\n\n# find average annual PPT per lat and long from 1980 to 2000\nclimate3_per = climate2_per[climate2_per['year'] <= 2000]\nclimate3_per = climate3_per.groupby(['lat', 'long'])['PPT_Annual'].mean().reset_index()\nclimate3_per = climate3_per.rename(columns={'PPT_Annual': 'PPT_Annual_Avg'})\n#print(climate3_per)\n```\n\n```{python, echo=False}\n# find average PPT_Annual per year, lat, long\nclimate2_per = climate2_per.groupby(['year', 'lat', 'long'])['PPT_Annual'].mean().reset_index()\nclimate2_per = pd.merge(climate2_per, climate3_per, on=['lat', 'long'], how='left')\nclimate2_per = climate2_per.dropna()\n#print(climate2_per.head())\n```\n\n```{python, echo=False}\n# find change\nclimate2_per['PPT_delta'] = climate2_per['PPT_Annual'] - climate2_per['PPT_Annual_Avg']\n#print(climate2_per.head())\n```\n\n```{python, echo=False}\n# normalize data\nscaler = StandardScaler()\nclimate2_per['PPT_delta_normal'] = scaler.fit_transform(climate2_per[['PPT_delta']])\n#print(climate2_per.head())\n```\n\n```{python, echo=False}\nclimate2_per = climate2_per[climate2_per['year']>=1983]\n```\n\n# Changing Precipitation Patterns\n\nPrecipitation patterns have also been changing in this region. As seen in the map below, there are fluctuations in the precipitation patterns from 1983 to 2024, but overall there is a downward trend in the average annual precipitation.\n\n```{python, echo=False}\n#| fig-cap: \"Beginning with data in 1983 and ending in 2024, each average annual precipitation was compared to the average annual precipitation between 1980 to 2000. The blue color decreases in intensity as precipitation decreases. The most remarkable difference is seen by comparing 1983 and 2024.\"\nyears = climate2_per['year'].unique()\nyears.sort()\n\nheat_df = []\nfor year in years:\n    year_df = climate2_per[climate2_per['year'] == year]\n    heat_df.append(year_df[['lat', 'long', 'PPT_delta_normal']].values.tolist())\n\n# Create a base map\nm = folium.Map(location=[climate2_per['lat'].mean(), climate2_per['long'].mean()], control_scale=True, zoom_start=13)\n\n# Add heatmap with time plugin\nHeatMapWithTime(\n    heat_df,\n    index=years.tolist(),\n    auto_play=True,\n    min_speed=3.5,\n    max_opacity=0.7,\n    gradient = {0.25: 'red', 0.5: 'yellow', 0.75: 'green', 1: 'blue'},\n    radius=25\n).add_to(m)\n\nm\n```\n\n\n\n```{python, echo=False}\naverage_prec_per_year = climate2_per.groupby('year')['PPT_Annual'].mean()\n\n\nplt.figure(figsize=(8, 6))  \nplt.plot(average_prec_per_year.index, average_prec_per_year.values, marker='o', linestyle='-')\nplt.title('Annual Precipitation from 1983 to 2024', fontsize=28)\nplt.xlabel('Year')\nplt.ylabel('Average Annual Precipitation')\nplt.grid(True)\nplt.xticks(average_prec_per_year.index, rotation=45) \nplt.tight_layout()  \nplt.show()\n```\n\n\n```{python, echo=False}\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler\n```\n\n```{python, echo=False}\nfrom matplotlib import style\n```\n\n```{python, echo=False}\nclimate = pd.read_csv('../data/NABR_historic.csv')\n#print(climate.info())\n#print(climate.head())\n```\n\n```{python, echo=False}\nclimate_near = pd.read_csv('../data/nearterm_data_2020-2024.csv')\n#print(climate_near.info())\n#print(climate_near.head())\n```\n\n```{python, echo=False}\nclimate_main = pd.concat([climate, climate_near], ignore_index=True)\n#print(climate_main.shape)\n#print(climate_main.info())\n```\n\n```{python, echo=False}\n#print(climate_main['RCP'].unique())\n```\n\n```{python, echo=False}\nclimate_main = climate_main.drop(columns=['TimePeriod', 'scenario', 'RCP'])\nscaler = StandardScaler()\nclimate_main_normal = scaler.fit_transform(climate_main)\nclimate_main = pd.DataFrame(climate_main_normal, columns=climate_main.columns)\n```\n\n\n\n```{python, echo=False}\nclimate_main = climate_main.rename(columns={'Ann_Herb': 'annual herb', 'Bare': 'bare ground', 'Herb': 'herb',\n       'Litter': 'plant litter', 'Shrub': 'shurbs', 'DrySoilDays_Summer_whole': 'dry soil days' , 'Evap_Summer': 'evap in summer',\n       'ExtremeShortTermDryStress_Summer_whole': 'extreme dry soil', 'FrostDays_Winter': 'frost days in winter',\n       'NonDrySWA_Summer_whole': 'non-dry soil water', 'PPT_Winter': 'PPT Winter', 'PPT_Summer': 'PPT Summer', \n       'PPT_Annual': 'PPT Annual',\n       'T_Winter': 'Temp Winter', 'T_Summer': 'Temp Summer', 'T_Annual': 'Temp Annual', 'Tmax_Summer': 'Max Temp Summer', \n       'Tmin_Winter': 'Min Temp Winter',\n       'VWC_Winter_whole': 'VWC Winter', 'VWC_Spring_whole': 'VWC Spring', 'VWC_Summer_whole': 'VWC Summer',\n       'VWC_Fall_whole': 'VWC Fall'})\n```\n\n```{python, echo=False}\n#climate_main1 = climate_main.drop(columns=['TimePeriod', 'scenario'])\nclimate_main1 = climate_main.drop(columns=['Min Temp Winter', 'VWC Winter', 'VWC Spring',\n                                          'VWC Summer', 'VWC Fall',\n                                          'non-dry soil water', 'frost days in winter',\n                                          'extreme dry soil',\n                                          'evap in summer', 'dry soil days'])\n\nclimate_main1 = climate_main1.dropna()\n#print(climate_main1.shape)\n#print(climate_main1.info())\n```\n\n```{python, echo=False}\nclimate_main2 = climate_main.drop(columns=['PPT Winter', 'PPT Summer', 'PPT Annual',\n                                          'Temp Winter', 'Temp Summer',\n                                          'Temp Annual', 'Max Temp Summer'])\n#climate_main2_normal = scaler.fit_transform(climate_main2)\n#climate_main2= pd.DataFrame(climate_main2_normal, columns=climate_main2.columns)\n#climate_main2 = climate_main2.dropna()\n#print(climate_main2.shape)\n#print(climate_main2.info())\n```\n\n```{python, echo=False}\ncorr_matrix = climate_main.dropna()\n#print(corr_matrix.info())\n```\n\n```{python, echo=False}\n\n\n#corr_matrix = corr_matrix.corr(method='pearson')\n\n#sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', center=0)\n#plt.show()\n```\n\n# Impact on Precipitation and Water Content in Soil\n\nChanges in annual temperature and precipitation may have impacts on other environmental factors. In the Pearson Correlation Plots below, subtle relationships are seen between temperature and precipitation to volumetric water content (VWC) and water available in dry soil. \n\n```{python, echo=False}\n#| fig-cap: \"The increasing intensity of the red color indicates a strong positive relationship while the blue color indicates an inverse relationship.\"\ncorr_matrix1 = climate_main1.corr(method='pearson')\n\nsns.heatmap(corr_matrix1, annot=True, cmap='coolwarm', center=0)\nplt.show()\n```\n\n\n```{python, echo=False}\n#| fig-cap: \"The increasing intensity of the red color indicates a strong positive relationship while the blue color indicates an inverse relationship.\"\ncorr_matrix2 = climate_main2.corr(method='pearson')\n\nsns.heatmap(corr_matrix2, annot=True, cmap='coolwarm')\nplt.show()\n```\n\n\n\n\n```{python, echo=False}\n#print(climate_main2.info())\n```\n\n```{python, echo=False}\n\nclimate_main2_mean = climate_main2.groupby(['long', 'lat', 'year']).agg({\n    'non-dry soil water': 'mean',\n    'VWC Winter': 'mean',\n    'VWC Spring': 'mean',\n    'VWC Summer': 'mean',\n    'VWC Fall': 'mean',\n}).reset_index()\n```\n\n```{python, echo=False}\n#print(climate_main2_mean.head())\n```\n\n\nThe Pearson correlation matrix show the beginnings of the impact of changes in temperature and precipitation. \n\n\n```{python, echo=False}\n#| fig-cap: \"This figure takes a closer look at the relationship between non-dry soil water availability during the summer.\"\nimport plotly.graph_objects as go\nimport pandas as pd\n\n\nfig = go.Figure(\n    data=go.Splom(\n        dimensions=[\n            dict(label=\"non-dry soil water\", values=climate_main2[\"non-dry soil water\"]),\n            dict(label=\"VWC Winter\", values=climate_main2[\"VWC Winter\"]),\n            dict(label=\"VWC Spring\", values=climate_main2[\"VWC Spring\"]),\n            dict(label=\"VWC Summer\", values=climate_main2[\"VWC Summer\"]),\n            dict(label=\"VWC Fall\", values=climate_main2[\"VWC Fall\"]),\n        ],\n        showupperhalf=False,\n        marker=dict(\n            showscale=False,\n            line_color=\"white\",\n            line_width=0.5,\n        ),\n    )\n)\n\nfig.update_layout(\n    title=\"Relationship between Non-dry Soil Water Availability and Seasonal VWC\",\n    hovermode=\"closest\",\n    width=800,\n    height=800,\n)\n\n#fig.theme(style.library[\"\"])\n\nfig.show()\n```\n\n\nIn this parallel coordinates plot, the extreme values at above 3.5 show a relationship to a decrease in volumetric water content (VWC) in winter, spring, summer, and fall. According to Sumon Datta et. al., VWC can influence plant growth, soil temperature, transport of chemicals and groundwater recharge.\n\n```{python, echo=False}\n#| fig-cap: \"By scrolling over the axis, a closer look at the relationship between extreme dry soil and VWC.\"\nfig = go.Figure(data=\n    go.Parcoords(\n        line = dict(#color = df['species_id'],\n                   colorscale = [[0,'purple'],[0.5,'lightseagreen'],[1,'gold']]),\n        dimensions = list([\n            dict(range = [0,6],\n                constraintrange = [4,6],\n                label=\"extreme dry soil\", values=climate_main2[\"extreme dry soil\"]),\n            dict(range = [0,6],\n                label=\"VWC Winter\", values=climate_main2[\"VWC Winter\"]),\n            dict(range = [0,6],\n                label=\"VWC Spring\", values=climate_main2[\"VWC Spring\"]),\n            dict(range = [0,6],\n                label=\"VWC Summer\", values=climate_main2[\"VWC Summer\"]),\n            dict(range = [0,6],\n                label=\"VWC Fall\", values=climate_main2[\"VWC Fall\"])\n        ])\n    )\n)\n\nfig.update_layout(\n    plot_bgcolor = 'white',\n    paper_bgcolor = 'white',\n    height = 450\n)\n\nfig.show()\n\n```\n\n# Conclusion\n\nThe data collected by the Southwestern Utah Group (SEUG) of National Parks shows the striking increase in extreme high temperatures, changes in precipitation, and subtle changes in water content in soil. These patterns have profound implications on our ecosystems. In an article by NASA, even one degree of temperature change can have catatrophic effects on the global ecosytem. Changes in temperature and precipitation may have negative impacts on our agricultural systems, which may also cause stress and strain on our future food sytems. It is critical that policy makers act urgently to reverse the effects of climate change. \n\n\n# Referenes\n\n1. NASA. (n.d.). Effects - NASA science. NASA. https://science.nasa.gov/climate-change/effects/ \n2. NASA. (n.d.-b). World of change: Global temperatures. NASA. https://earthobservatory.nasa.gov/world-of-change/global-temperatures\n3. Datta, S, et. al. (2018, August 1). Understanding soil water content and thresholds for irrigation management - Oklahoma State University. Understanding Soil Water Content and Thresholds for Irrigation Management | Oklahoma State University. https://extension.okstate.edu/fact-sheets/understanding-soil-water-content-and-thresholds-for-irrigation-management.html#:~:text=The%20volumetric%20water%20content%20is,water%20per%20foot%20of%20soil. \n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"embed-resources":true,"output-file":"natural_bridges.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.550","theme":"cosmo","title":"","jupyter":"python3"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}